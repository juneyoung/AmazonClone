<nav class="navbar navbar-inverse navbar-fixed-top">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
        <span class="sr-only">Toggle navigation</span>
        
      </button>
      <a class="navbar-brand" href="/">Ecommerce Project</a>
    </div> 


    <!-- Search box -->
    <form class='navbar-form navbar-left' method='post' action='/search'>
      <div class='form-group'>
        <input type='text' name='q' class='form-control' placeholder='Search...'>
        <button type='submit' class='btn btn-default'>Submit</button>
      </div>
    </form>




    <ul class="nav navbar-nav navbar-right">

      <!-- Category -->
      <li>
        <a class='dropdown-toggle' data-toggle='dropdown' href='#'>Categories</a>
        <ul class='dropdown-menu'>
          <% for(var idx in categories) { %>
            
            <li>
              <a href='products/<%= categories[idx]._id %>'>
                <%= categories[idx].name %>
              </a>
            </li>
          
          <% } %>
        </ul>
      </li>



      <% if(!user) { %>
      <!-- Not logged in -->
    	<li>
    		<a class='dropdown-toggle' data-toggle='dropdown' href='#'>Signup / Login</a>
    		<ul class='dropdown-menu'>
    			<li><a href='/signup'>Signup</a></li>
    			<li><a href='/login'>Login</a></li>
    		</ul>
    	</li>

      <% } else { %>


       <!-- Already logged in -->
      <li>
        <a class='dropdown-toggle' data-toggle='dropdown' href='#'><%= user.profile.name %></a>
        <ul class='dropdown-menu'>
          <li><a href='/profile'>Profile</a></li>
          <li><a href='/logout'>Logout</a></li>
        </ul>
      </li>

      <% } %>


      <!-- 
        Handling user cart (0327)
        'cart' is actually cart length.
        do not know why none-login user have cart length
      -->
      <% if(user) { %>
        <li>
          <a href='/cart' class='glyphicon glyphicon-shopping-cart'>
            <span class='badge'> <%= cart %> </span>
          </a>
        </li>
      <% } else { %>
        <li>
          <a href='/cart' class='glyphicon glyphicon-shopping-cart'>
            <span class='badge'> 0 </span>
          </a>
        </li>
      <% } %>


      
    </ul>


  </div>
</nav>